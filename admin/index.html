<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æœ¨å­AI åå°ç®¡ç†</title>
    <style>
      body {
        font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
        background-color: #f5f5f5;
        color: #333;
        text-align: center;
        margin: 0;
        padding: 80px 20px;
      }
      h2 {
        font-weight: 500;
        margin-bottom: 10px;
      }
      .loading {
        font-size: 16px;
        color: #777;
      }
    </style>
  </head>

  <body>
    <h2>æ­£åœ¨åŠ è½½ Decap CMS åå°...</h2>
    <div class="loading">è¯·ç¨å€™å‡ ç§’é’Ÿ</div>

    <!-- ä½¿ç”¨ jsDelivr ç¨³å®šåŠ è½½ Decap CMS -->
    <script src="https://cdn.jsdelivr.net/npm/decap-cms@2.15.72/dist/decap-cms.js"></script>

    <script>
      // ğŸ”¹ è‡ªåŠ¨å¯ç”¨å…ç™»å½•æ¨¡å¼ï¼ˆlocal_backendï¼‰
      (function () {
        const currentUrl = window.location.href;
        if (!currentUrl.includes("local_backend=true")) {
          const newUrl = currentUrl.includes("?")
            ? currentUrl + "&local_backend=true"
            : currentUrl + "?local_backend=true";
          window.location.replace(newUrl);
          return;
        }
      })();

      // ğŸ”¹ åˆå§‹åŒ– CMSï¼ˆCloudflare Pages å®Œå…¨æœ¬åœ°è¿è¡Œï¼‰
      document.addEventListener("DOMContentLoaded", function () {
        if (typeof CMS === "undefined") {
          document.body.innerHTML = "<p style='color:red'>âŒ CMS åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚</p>";
          return;
        }

        CMS.init({
          config: {
            local_backend: true,
            backend: {
              name: "git-gateway",
              branch: "main",
            },
            media_folder: "images/uploads",
            public_folder: "/images/uploads",
            site_url: "https://plus-e2d.pages.dev",
            display_url: "https://plus-e2d.pages.dev",
            collections: [
              {
                name: "posts",
                label: "æ–‡ç« å†…å®¹",
                folder: "content/posts",
                create: true,
                slug: "{{slug}}",
                fields: [
                  { label: "æ ‡é¢˜", name: "title", widget: "string" },
                  { label: "å‘å¸ƒæ—¥æœŸ", name: "date", widget: "datetime" },
                  { label: "å°é¢å›¾", name: "cover", widget: "image", required: false },
                  { label: "æ­£æ–‡å†…å®¹", name: "body", widget: "markdown" }
                ],
              },
              {
                name: "siteinfo",
                label: "ç½‘ç«™ä¿¡æ¯",
                files: [
                  {
                    name: "settings",
                    label: "åŸºç¡€é…ç½®",
                    file: "content/data.json",
                    fields: [
                      { label: "ç½‘ç«™æ ‡é¢˜", name: "title", widget: "string" },
                      { label: "å¾®ä¿¡å·", name: "wechat", widget: "string" },
                      { label: "é‚®ç®±", name: "email", widget: "string" },
                      { label: "ç‰ˆæƒä¿¡æ¯", name: "footer", widget: "text" }
                    ],
                  },
                ],
              },
            ],
          },
        });
      });
    </script>
  </body>
</html>
