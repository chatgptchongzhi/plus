<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>网站后台管理</title>
  </head>
  <body>
    <h2 style="text-align:center;font-family:sans-serif;">正在加载后台...</h2>
    <!-- 本地引入 Decap CMS（建议放到 assets/js/decap-cms.js） -->
    <script src="../assets/js/decap-cms.js"></script>

    <script>
      // 自动启用免登录本地模式
      (function() {
        const url = new URL(window.location);
        if (!url.searchParams.has("local_backend")) {
          url.searchParams.set("local_backend", "true");
          window.location.href = url.toString();
        }
      })();

      // 初始化 CMS
      document.addEventListener("DOMContentLoaded", function() {
        CMS.init({
          config: {
            local_backend: true,
            backend: { name: "git-gateway", branch: "main" },
            media_folder: "images/uploads",
            public_folder: "/images/uploads",
            collections: [
              {
                name: "posts",
                label: "文章内容",
                folder: "content/posts",
                create: true,
                slug: "{{slug}}",
                fields: [
                  { label: "标题", name: "title", widget: "string" },
                  { label: "发布日期", name: "date", widget: "datetime" },
                  { label: "正文内容", name: "body", widget: "markdown" }
                ]
              }
            ]
          }
        });
      });
    </script>
  </body>
</html>
