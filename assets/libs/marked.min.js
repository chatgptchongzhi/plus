/* Lightweight loader to ensure marked is available before use. */
(function (w, d) {
  var loaded = false, queue = [];
  function fire() {
    loaded = true;
    var q = queue.slice(); queue.length = 0;
    q.forEach(function (fn) { try { fn(); } catch (e) {} });
  }
  function load() {
    if (loaded || w.marked) return fire();
    var s = d.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js';
    s.onload = fire;
    s.onerror = fire; // 即便失败也继续，让调用方自行兜底
    d.head.appendChild(s);
  }
  w.__onMarkedReady = function (cb) {
    if (w.marked) return cb();
    queue.push(cb);
    if (!loaded) load();
  };
})(window, document);
